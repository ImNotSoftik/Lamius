From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: ruViolence <78062896+ruViolence@users.noreply.github.com>
Date: Fri, 10 Jun 2022 16:09:59 +0500
Subject: [PATCH] feat: configurable ping period


diff --git a/src/main/java/com/github/ruviolence/Lamius/LamiusConfig.java b/src/main/java/com/github/ruviolence/Lamius/LamiusConfig.java
index 02a4c00bb4de0f989a1fc4a920925c5d9c8213f3..31e46554ef0c33785c17acb43a1a157ff72d8583 100644
--- a/src/main/java/com/github/ruviolence/Lamius/LamiusConfig.java
+++ b/src/main/java/com/github/ruviolence/Lamius/LamiusConfig.java
@@ -259,4 +259,9 @@ public class LamiusConfig {
     private static void roundPlayerPing() {
         roundPlayerPing = getBoolean("round-player-ping", false);
     }
+
+    public static long pingPeriod;
+    private static void pingPeriod() {
+        pingPeriod = MathHelper.clamp(getInt("ping-period", 15), 1, 30) * 1000L;
+    }
 }
diff --git a/src/main/java/net/minecraft/server/PlayerConnection.java b/src/main/java/net/minecraft/server/PlayerConnection.java
index 06f8da246caf5e85cafd0dbb3b2ecb80483c09c6..331de13e0eace3dd9b8f1ff3cb92c18691bb2683 100644
--- a/src/main/java/net/minecraft/server/PlayerConnection.java
+++ b/src/main/java/net/minecraft/server/PlayerConnection.java
@@ -193,7 +193,7 @@ public class PlayerConnection implements PacketListenerPlayIn, ITickable {
                 this.disconnect(new ChatMessage("disconnect.timeout"));
             }
         } else {
-            if (elapsedTime >= 15000L) { // 15 seconds
+            if (elapsedTime >= com.github.ruviolence.Lamius.LamiusConfig.pingPeriod) { // Lamius
                 this.setPendingPing(true);
                 this.setLastPing(currentTime);
                 this.setKeepAliveID(currentTime);
